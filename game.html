<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸï¸ Ø³Ø¨Ø§Ù‚ Ø§Ù„Ø³Ø±Ø¹Ø©</title>
<style>
  body {
    background: #222;
    margin: 0;
    overflow: hidden;
    display: flex;
    justify-content: center;
  }
  canvas {
    background: #444;
    display: block;
    border: 2px solid #fff;
  }
  .controls {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: grid;
    grid-template-columns: 60px 60px 60px;
    grid-template-rows: 60px 60px;
    gap: 10px;
  }
  .btn {
    background: #666;
    border: none;
    border-radius: 10px;
    font-size: 1.5em;
    color: white;
    touch-action: none;
  }
  .btn:active {
    background: #0f0;
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ -->
<div class="controls">
  <div></div>
  <button id="up" class="btn">â†‘</button>
  <div></div>
  <button id="left" class="btn">â†</button>
  <div></div>
  <button id="right" class="btn">â†’</button>
  <div></div>
  <button id="down" class="btn">â†“</button>
  <div></div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// Ø§Ù„Ø³ÙŠØ§Ø±Ø©
let car = { x: 180, y: 500, w: 40, h: 80, speed: 4 };

// Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
let enemies = [];
let enemySpeed = 3;
let score = 0;

// ØªØ­Ø±ÙŠÙƒ
let up = false, down = false, left = false, right = false;

// Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø¯Ùˆ
function spawnEnemy() {
  let ex = Math.random() * (canvas.width - 40);
  enemies.push({ x: ex, y: -80, w: 40, h: 80 });
}

// Ø±Ø³Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø©
function drawCar(c, color) {
  ctx.fillStyle = color;
  ctx.fillRect(c.x, c.y, c.w, c.h);
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø¹Ø¨Ø©
function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù„Ø§Ø¹Ø¨
  if (up) car.y -= car.speed;
  if (down) car.y += car.speed;
  if (left) car.x -= car.speed;
  if (right) car.x += car.speed;

  // Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø´Ø§Ø´Ø©
  if (car.x < 0) car.x = 0;
  if (car.x + car.w > canvas.width) car.x = canvas.width - car.w;
  if (car.y < 0) car.y = 0;
  if (car.y + car.h > canvas.height) car.y = canvas.height - car.h;

  // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
  drawCar(car, "lime");

  // Ø±Ø³Ù… Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ ÙˆØªØ­Ø±ÙŠÙƒÙ‡Ù…
  for (let i = enemies.length - 1; i >= 0; i--) {
    let e = enemies[i];
    e.y += enemySpeed;
    drawCar(e, "red");

    // Ø¥Ø²Ø§Ù„Ø© Ø¥Ø°Ø§ Ø®Ø±Ø¬ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø©
    if (e.y > canvas.height) {
      enemies.splice(i, 1);
      score++;
    }

    // Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù…
    if (
      car.x < e.x + e.w &&
      car.x + car.w > e.x &&
      car.y < e.y + e.h &&
      car.y + car.h > e.y
    ) {
      alert("ğŸ’¥ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ù„Ù†ØªÙŠØ¬Ø©: " + score);
      document.location.reload();
    }
  }

  // ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Ù‚Ø§Ø·
  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("Ø§Ù„Ù†Ù‚Ø§Ø·: " + score, 10, 20);

  requestAnimationFrame(update);
}

// Ø£Ø²Ø±Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp") up = true;
  if (e.key === "ArrowDown") down = true;
  if (e.key === "ArrowLeft") left = true;
  if (e.key === "ArrowRight") right = true;
});
document.addEventListener("keyup", e => {
  if (e.key === "ArrowUp") up = false;
  if (e.key === "ArrowDown") down = false;
  if (e.key === "ArrowLeft") left = false;
  if (e.key === "ArrowRight") right = false;
});

// Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„Ù…Ø³
function bindBtn(id, start, end) {
  let btn = document.getElementById(id);
  btn.addEventListener("touchstart", e => { e.preventDefault(); start(); });
  btn.addEventListener("touchend", e => { e.preventDefault(); end(); });
  btn.addEventListener("mousedown", e => { e.preventDefault(); start(); });
  btn.addEventListener("mouseup", e => { e.preventDefault(); end(); });
}

bindBtn("up", () => up = true, () => up = false);
bindBtn("down", () => down = true, () => down = false);
bindBtn("left", () => left = true, () => left = false);
bindBtn("right", () => right = true, () => right = false);

// Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
setInterval(spawnEnemy, 1000);
update();
</script>

</body>
</html>
